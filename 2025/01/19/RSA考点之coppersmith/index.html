

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="Coppersmith攻击一、引言近期参加的各类CTF比赛中，常见到coppersmith攻击的考点，于是在此做一个简单的学习与总结，后续若还有新的coppersmith的考点，会在文章中作出补充。 二、Coppersmith攻击原理真正能够用好一个方法，一定要搞清楚这个方法背后的本质原理，于是我在网上搜集资料，找到了Coppersmith攻击的原理。 对于**$f(x)&#x3D;a_1x^m+">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA考点之coppersmith">
<meta property="og:url" content="http://example.com/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith/index.html">
<meta property="og:site_name" content="Hanson&#39;s blog">
<meta property="og:description" content="Coppersmith攻击一、引言近期参加的各类CTF比赛中，常见到coppersmith攻击的考点，于是在此做一个简单的学习与总结，后续若还有新的coppersmith的考点，会在文章中作出补充。 二、Coppersmith攻击原理真正能够用好一个方法，一定要搞清楚这个方法背后的本质原理，于是我在网上搜集资料，找到了Coppersmith攻击的原理。 对于**$f(x)&#x3D;a_1x^m+">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-01-18T16:00:00.000Z">
<meta property="article:modified_time" content="2025-01-20T04:01:23.301Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>RSA考点之coppersmith - Hanson&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"XCXsrmY8Pqx1RwSkGAGvlaPr-gzGzoHsz","app_key":"w8VLq11fpyxpeRE9NvUdzbMH","server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Hanson&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="RSA考点之coppersmith"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-01-19 00:00" pubdate>
          2025年1月19日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          17 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">RSA考点之coppersmith</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Coppersmith攻击"><a href="#Coppersmith攻击" class="headerlink" title="Coppersmith攻击"></a>Coppersmith攻击</h1><h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>近期参加的各类CTF比赛中，常见到coppersmith攻击的考点，于是在此做一个简单的学习与总结，后续若还有新的coppersmith的考点，会在文章中作出补充。</p>
<h2 id="二、Coppersmith攻击原理"><a href="#二、Coppersmith攻击原理" class="headerlink" title="二、Coppersmith攻击原理"></a>二、Coppersmith攻击原理</h2><p>真正能够用好一个方法，一定要搞清楚这个方法背后的本质原理，于是我在网上搜集资料，找到了Coppersmith攻击的原理。</p>
<p>对于**$f(x)&#x3D;a_1x^m+a_2x^{m-1}+\cdots+a_m+1$**,要找到这个多项式在$mod(N)$意义下的根，在不限制的条件下这是一个很困难的问题。</p>
<p>因为$f(x)$可以特别大只需要是$N$的倍数就可以</p>
<p>$mod(N)$这一步带来很多困难.</p>
<p>首先考虑一个特殊情况如果$f(x)$就等于0那么可以用牛顿迭代法求出来但是牛顿迭代法遇到$mod(N)$就失灵了.</p>
<p><strong>怎么办呢？没有条件就创造条件！</strong></p>
<p>大概的思路是如果$x$足够小使得$\vert f(x)\vert$|$&lt;N$那么$f(x)&#x3D;&#x3D;0$</p>
<p>这时候就满足了使用牛顿迭代法的条件</p>
<p>那么现在问题集中在怎么证明$\vert f(x)\vert$|$&lt;N$.答案是：无法证明！因为没有限制$a_i$的大小</p>
<p>Coppersmith想出了一个办法：能不能找一个系数的多项式$g(x)$当$x&#x3D;0$时$f(x)&#x3D;0$</p>
<p>也就是说希望找到一个系数的多项式系数小到能够满足牛顿迭代法的要求那么问题就解决了，就差把x求出来。</p>
<p><strong>Coppersmith利用如下操作先得到一系列</strong>$h(x)：$$h_{ij}(x)&#x3D;x^i*f^j(x)$</p>
<p>$再将一系列的h(x)经过线性组合得到g(x):g(x)&#x3D;\sum c_{ij}*h_{ij}(x)+d_{ij}$</p>
<p>为了让$g(x)$的系数尽量小就要用到LLL格基规约算法（关于LLL格基规约算法将在下一个博客中给出学习介绍）</p>
<h2 id="三、Coppersmith攻击在CTF比赛中的运用"><a href="#三、Coppersmith攻击在CTF比赛中的运用" class="headerlink" title="三、Coppersmith攻击在CTF比赛中的运用"></a>三、Coppersmith攻击在CTF比赛中的运用</h2><p>在CTF比赛中，使用Coppersmith攻击的主要原理是根据以下公式完成的：</p>
<p>$c&#x3D;(m+t)^e (mod N)$</p>
<p>这里只需要将t看成上述的x，即可把这个公式转换为求解一个有关t的多项式的根，其中，t要求不能太大，否则无法使用Coppersmith攻击原理解决</p>
<p>具体来说，我们一般会在sagemath中利用$small roots$函数来解决</p>
<p><code>small_roots()</code>是<code>SageMath</code>中一个运用了<code>coppersmith</code>定理的函数。它只能解有限域内的方程。</p>
<p>small_roots(X &#x3D; ,beta &#x3D; ) 有两个参数</p>
<p>X代表所需要求解根的上限；虽然是根的上限，并不是说上限越高越好，当上限超过某个值的时候就会计算失效，即使已知二进制位数满足条件，也无法用此函数求得结果；所以一般来说X取在给定情况下的最大求解上限</p>
<p>那么下面，我们给出几个题目来理解一下Coppersmith攻击的运用吧</p>
<h3 id="1、极客：highlow"><a href="#1、极客：highlow" class="headerlink" title="1、极客：highlow"></a>1、极客：highlow</h3><p>先看题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>pxor = p ^ (bytes_to_long(flag)&lt;&lt;<span class="hljs-number">400</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)== <span class="hljs-number">44</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;pxor =&#x27;</span>,pxor)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br><span class="hljs-string">n = 14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br><span class="hljs-string">pxor = 124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>$44*8+400&#x3D;752$<br>$1024-752&#x3D;272<br>所以p高272已知<br>phigh &#x3D;(pxor&gt;&gt;752)&lt;&lt;752$<br>$plow&#x3D; pxor%2^{400}$<br>已知672位，1024-672&#x3D;352 末知<br>$352\div\mathrm{1024}\leq0.44$<br>可用small roots()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br>n = <span class="hljs-number">14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br>pxor = <span class="hljs-number">124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br>phigh=(pxor&gt;&gt;<span class="hljs-number">752</span>)&lt;&lt;<span class="hljs-number">752</span><br>plow = pxor%<span class="hljs-number">2</span>**<span class="hljs-number">400</span><br><span class="hljs-built_in">print</span>(phigh)<br><span class="hljs-built_in">print</span>(plow)<br>R.&lt;x&gt;= PolynomialRing(zmod(n))<br>f= phigh + x*<span class="hljs-number">2</span>**<span class="hljs-number">400</span> + plow<br>f= f.monic()<br>root =f.small_roots(x=<span class="hljs-number">2</span>^<span class="hljs-number">352</span>,beta=<span class="hljs-number">0.4</span>)<br><span class="hljs-built_in">print</span>(root)<br><span class="hljs-keyword">if</span> root:<br>p=<span class="hljs-built_in">int</span>(phigh + root[<span class="hljs-number">0</span>]*<span class="hljs-number">2</span>**<span class="hljs-number">400</span> + plow)<br>q = n//p<br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m= <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-keyword">else</span>:<br><span class="hljs-built_in">print</span>(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>

<h3 id="2、i春秋冬季赛-RSA1"><a href="#2、i春秋冬季赛-RSA1" class="headerlink" title="2、i春秋冬季赛 RSA1"></a>2、i春秋冬季赛 RSA1</h3><p>这是一道我比较喜欢的题目🤭考察Coppersmith以及简单的数论知识。</p>
<p>题目代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> uuid<br>p, q = [getPrime(<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>N = p * q<br>flag = <span class="hljs-string">b&#x27;flag&#123;&#x27;</span> + <span class="hljs-built_in">str</span>(uuid.uuid4()).encode() + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>flag += <span class="hljs-built_in">bin</span>(getPrime((<span class="hljs-number">1024</span> - bytes_to_long(flag).bit_length()) / <span class="hljs-number">8</span>)).encode()<br>m1 = bytes_to_long(flag)<br>m2 = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i) + <span class="hljs-number">3</span>) % <span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag.decode()).encode())<br>e = getPrime(<span class="hljs-number">128</span>)<br>c1 = <span class="hljs-built_in">pow</span>(m1 * e, <span class="hljs-number">2835</span>, N)<br>c2 = <span class="hljs-built_in">pow</span>(m2, <span class="hljs-number">2025</span>, N)<br>c3 = <span class="hljs-built_in">pow</span>(m2, <span class="hljs-number">2835</span>, N) + e<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;N = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c1 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c2 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c3 = &#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">N =</span><br><span class="hljs-string">17687156112047658916576175030063333258687770834244899450617562420363386011962151231832</span><br><span class="hljs-string">11729278763896319183001842210823177413803654471977770262564053122127166306177216069180</span><br><span class="hljs-string">66048995683899616059388173629437673018386590043053146712870572300799479269947118251011</span><br><span class="hljs-string">967950970286626852935438101046112260915112568392601</span><br><span class="hljs-string">c1 =</span><br><span class="hljs-string">47280375006817082521114885578132104427687384457963920263778661542552259860890075321953</span><br><span class="hljs-string">56386765823334793012150783561241727843897900670501653759635767903847117695765983415569</span><br><span class="hljs-string">42843646827596758418082098123160949653935505099139848888499454210924638425466312286402</span><br><span class="hljs-string">93794745005338773574343676100121000764021207044019</span><br><span class="hljs-string">c2 =</span><br><span class="hljs-string">17623141093397913458588607801393364949837987344485194322493501097245276989960336468615</span><br><span class="hljs-string">82792691978911906437250081518121504288085503105877090086833394365901128027567671401021</span><br><span class="hljs-string">36304346001599401670291938369014436170693864034099138767167055456635760196888578642643</span><br><span class="hljs-string">971920733784690410395944410255241615897032471127315</span><br><span class="hljs-string">c3 =</span><br><span class="hljs-string">13559480788401697135681642316912816872734610240849028962388521117961957135410510239365</span><br><span class="hljs-string">82492923331793464974151297851846540082997256176686556408573180639927032654071620851788</span><br><span class="hljs-string">85733134590524577996093366819328960462500124201402816244104477018279673183368074374836</span><br><span class="hljs-string">717994805448310223434099196774685324616523478136309</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>根据上述题目代码，我们有：</p>
<p>$c_2\equiv m_2^{2025} mod(N)$</p>
<p>$c_3-e\equiv m_2^{2835} mod(N)$</p>
<p>观察2025与2835这两个数字，突然顿悟，发现他们的最大公约数为14175！</p>
<p>于是进行线性变化：</p>
<p>$(c_3-e)^5 - c_2^7&#x3D;0  mod(N)$</p>
<p><strong>至此，我们便可以使用Coppersmith攻击原理，求出e了！</strong></p>
<p>接下来就是其他知识点的考察了，不过我们能发现，运用Coppersmith我们对这道题的进度推进了很多！</p>
<p>我们注意到：</p>
<p>$m_1&#x3D;\sum 256^i*flag_i$</p>
<p>$m2 &#x3D; \sum 256^i *(flag_i+3)$</p>
<p>(这里利用了bytes_to_long函数的原理，将每个字符转换为八位二进制的数)</p>
<p>我们发现$m_2-m_1$是一个定值</p>
<p>于是我们可以对以下两个式子做相关消息攻击：</p>
<p>$c_1\equiv (e*m_1)^{2835} mod(N)$</p>
<p>$c_2\equiv (m_1+b)^{2025} mod(N)$</p>
<p>而m是大于n的，所以还需要做小范围爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">HGCD</span>(<span class="hljs-params">a, b</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-number">2</span> * b.degree() &lt; a.degree() <span class="hljs-keyword">or</span> a.degree() = <span class="hljs-number">1</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>m = a.degree() / <span class="hljs-number">2</span><br>a_top, a_bot = a.quo_rem(x^m)<br>b_top, b_bot = b.quo_rem(x^m)<br>R00, R01, R10, R11 = HGCD(a_top, b_top)<br>c = R00 * a + R01 * b<br>d = R10 * a + R11 * b<br>q, e = c.quo_rem(d)<br>d_top, d_bot = d.quo_rem(x^(m / <span class="hljs-number">2</span>))<br>e_top, e_bot = e.quo_rem(x^(m / <span class="hljs-number">2</span>))<br>S00, S01, S10, S11 = HGCD(d_top, e_top)<br>RET00 = S01 * R00 + (S00 - q * S01) * R10<br>RET01 = S01 * R01 + (S00 - q * S01) * R11<br>RET10 = S11 * R00 + (S10 - q * S11) * R10<br>RET11 = S11 * R01 + (S10 - q * S11) * R11<br><span class="hljs-keyword">return</span> RET00, RET01, RET10, RET11<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GCD</span>(<span class="hljs-params">a, b</span>):<br><span class="hljs-built_in">print</span>(a.degree(), b.degree())<br>q, r = a.quo_rem(b)<br><span class="hljs-keyword">if</span> r = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> b<br>R00, R01, R10, R11 = HGCD(a, b)<br>c = R00 * a + R01 * b<br>d = R10 * a + R11 * b<br><span class="hljs-keyword">if</span> d = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> c.monic()<br>q, r = c.quo_rem(d)<br><span class="hljs-keyword">if</span> r = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> d<br><span class="hljs-keyword">return</span> GCD(d, r)<br>sys.setrecursionlimit(<span class="hljs-number">500000</span>)<br>N =<br><span class="hljs-number">17687156112047658916576175030063333258687770834244899450617562420363386011962151231832</span><br><span class="hljs-number">11729278763896319183001842210823177413803654471977770262564053122127166306177216069180</span><br><span class="hljs-number">66048995683899616059388173629437673018386590043053146712870572300799479269947118251011</span><br><span class="hljs-number">967950970286626852935438101046112260915112568392601</span><br>c1 =<br><span class="hljs-number">47280375006817082521114885578132104427687384457963920263778661542552259860890075321953</span><br><span class="hljs-number">56386765823334793012150783561241727843897900670501653759635767903847117695765983415569</span><br><span class="hljs-number">42843646827596758418082098123160949653935505099139848888499454210924638425466312286402</span><br><span class="hljs-number">93794745005338773574343676100121000764021207044019</span><br>c2 =<br><span class="hljs-number">17623141093397913458588607801393364949837987344485194322493501097245276989960336468615</span><br><span class="hljs-number">82792691978911906437250081518121504288085503105877090086833394365901128027567671401021</span><br><span class="hljs-number">36304346001599401670291938369014436170693864034099138767167055456635760196888578642643</span><br><span class="hljs-number">971920733784690410395944410255241615897032471127315</span><br>c3 =<br><span class="hljs-number">13559480788401697135681642316912816872734610240849028962388521117961957135410510239365</span><br><span class="hljs-number">82492923331793464974151297851846540082997256176686556408573180639927032654071620851788</span><br><span class="hljs-number">85733134590524577996093366819328960462500124201402816244104477018279673183368074374836</span><br><span class="hljs-number">717994805448310223434099196774685324616523478136309</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(N))<br>f = (c3 - x)^<span class="hljs-number">5</span> - c2^<span class="hljs-number">7</span><br>res = f.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.02</span>)<br>e = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>b =<br><span class="hljs-number">13860425563098439450464440586299944110869145799054471005966486822062551343046248376311</span><br><span class="hljs-number">97972917799925293608240198869587597177368766614530443357455736033307618174328289246889</span><br><span class="hljs-number">93026332102549607397901351619425324993583087500714061523945925857368498922102768458574</span><br><span class="hljs-number">857510324727265052999967460998294909713988129273348867</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(N))<br>f = (e * x)^<span class="hljs-number">2835</span> - c1<br>g = (x + b)^<span class="hljs-number">2025</span> - c2<br>res = GCD(f,g)<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>m = <span class="hljs-built_in">int</span>(-res.monic().coefficients()[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;m mod N = <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> trange(<span class="hljs-number">2</span>^<span class="hljs-number">16</span>):<br>mm = m + k*N<br>flag = long_to_bytes(<span class="hljs-built_in">int</span>(mm))<br><span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> flag:<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">break</span><br><span class="hljs-comment"># flag&#123;2404dcef-4223-417d-aee0-c236241f2320&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="3、西湖论剑-matrix-RSA"><a href="#3、西湖论剑-matrix-RSA" class="headerlink" title="3、西湖论剑 matrix RSA"></a>3、西湖论剑 matrix RSA</h3><p>先上题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>ext_len = <span class="hljs-number">9</span>*<span class="hljs-number">23</span> - <span class="hljs-built_in">len</span>(flag)<br>flag += <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.printable) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ext_len))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_rsa_encrypt</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p * q<br>    data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        data.append(bytes_to_long(flag[<span class="hljs-number">23</span>*i:<span class="hljs-number">23</span>*(i+<span class="hljs-number">1</span>)].encode()))<br>    M = Matrix(Zmod(n), [data[i:i+<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">3</span>)])<br>    e = <span class="hljs-number">65537</span><br>    C = M**e<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p &gt;&gt; <span class="hljs-number">100</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br>    <span class="hljs-keyword">return</span> C<br>C = my_rsa_encrypt()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;C =&quot;</span>, C)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">high_p = 12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551353785064416812665744581355110400</span><br><span class="hljs-string">p = 9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span><br><span class="hljs-string">n = 132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br><span class="hljs-string">C = [130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941  71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757  67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615]</span><br><span class="hljs-string">[ 23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993   9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601  44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401]</span><br><span class="hljs-string">[ 67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572  13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727  95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676]</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>我们能发现这里也有Coppersmith的踪迹！</p>
<p>于是先把p，q求出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br>p4 = <span class="hljs-number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span><br>e =  <span class="hljs-number">65537</span><br>pbits = <span class="hljs-number">512</span><br>kbits = pbits - p4.nbits()<br><span class="hljs-built_in">print</span>(p4.nbits())<br>p4 = p4 &lt;&lt; kbits<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x + p4<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">0.4</span>)<br><span class="hljs-keyword">if</span> roots:        <br>	p = p4+<span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>]) <br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n= &quot;</span>+<span class="hljs-built_in">str</span>(n))<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p= &quot;</span>+<span class="hljs-built_in">str</span>(p))<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q= &quot;</span>+<span class="hljs-built_in">str</span>(n//p))<br></code></pre></td></tr></table></figure>

<p>接下来就是一个非线性费马定理的使用了，这是以前从来没有接触过的东西捏<del>(￣▽￣)</del>*，也感谢学长的帮助，给到了文献参考！</p>
<p>[]: <a target="_blank" rel="noopener" href="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf">https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n= <span class="hljs-number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br>p= <span class="hljs-number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span><br>q= <span class="hljs-number">10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span><br>e=<span class="hljs-number">65537</span><br>C =  [(<span class="hljs-number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,<span class="hljs-number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,<span class="hljs-number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>),(<span class="hljs-number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>, <span class="hljs-number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>, <span class="hljs-number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>), (<span class="hljs-number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>, <span class="hljs-number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>, <span class="hljs-number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>)]<br>C = matrix(Zmod(n), C)<br>phi=(p**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*(q**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>d = inverse(e,phi)<br>M = C**d<br>flag = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        m = <span class="hljs-built_in">int</span>(M[i,j])<br>        flag += long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h1 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h1><p>总的来说，Coppersmith攻击的考察是十分常见的，这一般用于解决 RSA 攻击中“已知某些二进制位，求剩余位”这一类问题</p>
<p>当然，Coppersmith攻击很少会直接考察，一般会与其他知识点结合起来形成综合题</p>
<p>因此，不断深入学习其他攻击方式也是十分重要的！</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/RSA/" class="category-chain-item">RSA</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>RSA考点之coppersmith</div>
      <div>http://example.com/2025/01/19/RSA考点之coppersmith/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年1月19日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith1/" title="RSA考点之coppersmith">
                        <span class="hidden-mobile">RSA考点之coppersmith</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"XCXsrmY8Pqx1RwSkGAGvlaPr-gzGzoHsz","appKey":"w8VLq11fpyxpeRE9NvUdzbMH","path":"window.location.pathname","placeholder":"说点什么","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
