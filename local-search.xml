<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>RSA考点之coppersmith</title>
    <link href="/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith/"/>
    <url>/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith/</url>
    
    <content type="html"><![CDATA[<h1 id="Coppersmith攻击"><a href="#Coppersmith攻击" class="headerlink" title="Coppersmith攻击"></a>Coppersmith攻击</h1><h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>近期参加的各类CTF比赛中，常见到coppersmith攻击的考点，于是在此做一个简单的学习与总结，后续若还有新的coppersmith的考点，会在文章中作出补充。</p><h2 id="二、Coppersmith攻击原理"><a href="#二、Coppersmith攻击原理" class="headerlink" title="二、Coppersmith攻击原理"></a>二、Coppersmith攻击原理</h2><p>真正能够用好一个方法，一定要搞清楚这个方法背后的本质原理，于是我在网上搜集资料，找到了Coppersmith攻击的原理。</p><p>对于**$f(x)&#x3D;a_1x^m+a_2x^{m-1}+\cdots+a_m+1$**,要找到这个多项式在$mod(N)$意义下的根，在不限制的条件下这是一个很困难的问题。</p><p>因为$f(x)$可以特别大只需要是$N$的倍数就可以</p><p>$mod(N)$这一步带来很多困难.</p><p>首先考虑一个特殊情况如果$f(x)$就等于0那么可以用牛顿迭代法求出来但是牛顿迭代法遇到$mod(N)$就失灵了.</p><p><strong>怎么办呢？没有条件就创造条件！</strong></p><p>大概的思路是如果$x$足够小使得$\vert f(x)\vert$|$&lt;N$那么$f(x)&#x3D;&#x3D;0$</p><p>这时候就满足了使用牛顿迭代法的条件</p><p>那么现在问题集中在怎么证明$\vert f(x)\vert$|$&lt;N$.答案是：无法证明！因为没有限制$a_i$的大小</p><p>Coppersmith想出了一个办法：能不能找一个系数的多项式$g(x)$当$x&#x3D;0$时$f(x)&#x3D;0$</p><p>也就是说希望找到一个系数的多项式系数小到能够满足牛顿迭代法的要求那么问题就解决了，就差把x求出来。</p><p><strong>Coppersmith利用如下操作先得到一系列</strong>$h(x)：$$h_{ij}(x)&#x3D;x^i*f^j(x)$</p><p>$再将一系列的h(x)经过线性组合得到g(x):g(x)&#x3D;\sum c_{ij}*h_{ij}(x)+d_{ij}$</p><p>为了让$g(x)$的系数尽量小就要用到LLL格基规约算法（关于LLL格基规约算法将在下一个博客中给出学习介绍）</p><h2 id="三、Coppersmith攻击在CTF比赛中的运用"><a href="#三、Coppersmith攻击在CTF比赛中的运用" class="headerlink" title="三、Coppersmith攻击在CTF比赛中的运用"></a>三、Coppersmith攻击在CTF比赛中的运用</h2><p>在CTF比赛中，使用Coppersmith攻击的主要原理是根据以下公式完成的：</p><p>$c&#x3D;(m+t)^e (mod N)$</p><p>这里只需要将t看成上述的x，即可把这个公式转换为求解一个有关t的多项式的根，其中，t要求不能太大，否则无法使用Coppersmith攻击原理解决</p><p>具体来说，我们一般会在sagemath中利用$small roots$函数来解决</p><p><code>small_roots()</code>是<code>SageMath</code>中一个运用了<code>coppersmith</code>定理的函数。它只能解有限域内的方程。</p><p>small_roots(X &#x3D; ,beta &#x3D; ) 有两个参数</p><p>X代表所需要求解根的上限；虽然是根的上限，并不是说上限越高越好，当上限超过某个值的时候就会计算失效，即使已知二进制位数满足条件，也无法用此函数求得结果；所以一般来说X取在给定情况下的最大求解上限</p><p>那么下面，我们给出几个题目来理解一下Coppersmith攻击的运用吧</p><h3 id="1、极客：highlow"><a href="#1、极客：highlow" class="headerlink" title="1、极客：highlow"></a>1、极客：highlow</h3><p>先看题目：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>pxor = p ^ (bytes_to_long(flag)&lt;&lt;<span class="hljs-number">400</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)== <span class="hljs-number">44</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;pxor =&#x27;</span>,pxor)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">c = 11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br><span class="hljs-string">n = 14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br><span class="hljs-string">pxor = 124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>$44*8+400&#x3D;752$<br>$1024-752&#x3D;272<br>所以p高272已知<br>phigh &#x3D;(pxor&gt;&gt;752)&lt;&lt;752$<br>$plow&#x3D; pxor%2^{400}$<br>已知672位，1024-672&#x3D;352 末知<br>$352\div\mathrm{1024}\leq0.44$<br>可用small roots()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">11017336122691034053241992293963114590816319844384287448629663672049205892828600396465505710922907685545939978376321927394655458727494361852952898280905220963163625482295222856129164172619564344634365520328815972232825639292605311741655988427166811406091329613627961070231457035303298793651546412496975662225857123805867756651901374507447803198638466304862480202099076813471571495380132563252630789218173007275890600746758285415274434393381125742526014986039652677605642226576741424053749512280825231217420239089105794080707322357602941046822659335487420672699022969372037662958497832065752272061853723653365171768556</span><br>n = <span class="hljs-number">14091206320622523674847720139761543154822190879035380245424481267482550932229611965964424965958386255076593911062804299275581742665134207390532802109700225140999812698020838683697375891035625255222001884477214361835101442288725383073334392995186053867261497679234362794914108033574681292656522807928680812726462195077833184018122369579002715900477290345396065912536529290811962117814900448319776590712946259540382461632468634827959957286905806432005632864663985014872365672653476822833921870071851313424903481282350342304819149894610089804321405589433980650340610521659031234826823369114800150883988613877877881069579</span><br>pxor = <span class="hljs-number">124229245244085791439650934438639686782423445183921252684721764061493908790073948877623812930339081158169421854801552819088679937157357924845248082716160727839419054107753000815066526032809275137495740454967765165248115412626716101315676902716808647904092798908601183908297141420793614426863816161203796966951</span><br>phigh=(pxor&gt;&gt;<span class="hljs-number">752</span>)&lt;&lt;<span class="hljs-number">752</span><br>plow = pxor%<span class="hljs-number">2</span>**<span class="hljs-number">400</span><br><span class="hljs-built_in">print</span>(phigh)<br><span class="hljs-built_in">print</span>(plow)<br>R.&lt;x&gt;= PolynomialRing(zmod(n))<br>f= phigh + x*<span class="hljs-number">2</span>**<span class="hljs-number">400</span> + plow<br>f= f.monic()<br>root =f.small_roots(x=<span class="hljs-number">2</span>^<span class="hljs-number">352</span>,beta=<span class="hljs-number">0.4</span>)<br><span class="hljs-built_in">print</span>(root)<br><span class="hljs-keyword">if</span> root:<br>p=<span class="hljs-built_in">int</span>(phigh + root[<span class="hljs-number">0</span>]*<span class="hljs-number">2</span>**<span class="hljs-number">400</span> + plow)<br>q = n//p<br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m= <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-keyword">else</span>:<br><span class="hljs-built_in">print</span>(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><h3 id="2、i春秋冬季赛-RSA1"><a href="#2、i春秋冬季赛-RSA1" class="headerlink" title="2、i春秋冬季赛 RSA1"></a>2、i春秋冬季赛 RSA1</h3><p>这是一道我比较喜欢的题目🤭考察Coppersmith以及简单的数论知识。</p><p>题目代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> uuid<br>p, q = [getPrime(<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>N = p * q<br>flag = <span class="hljs-string">b&#x27;flag&#123;&#x27;</span> + <span class="hljs-built_in">str</span>(uuid.uuid4()).encode() + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>flag += <span class="hljs-built_in">bin</span>(getPrime((<span class="hljs-number">1024</span> - bytes_to_long(flag).bit_length()) / <span class="hljs-number">8</span>)).encode()<br>m1 = bytes_to_long(flag)<br>m2 = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i) + <span class="hljs-number">3</span>) % <span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag.decode()).encode())<br>e = getPrime(<span class="hljs-number">128</span>)<br>c1 = <span class="hljs-built_in">pow</span>(m1 * e, <span class="hljs-number">2835</span>, N)<br>c2 = <span class="hljs-built_in">pow</span>(m2, <span class="hljs-number">2025</span>, N)<br>c3 = <span class="hljs-built_in">pow</span>(m2, <span class="hljs-number">2835</span>, N) + e<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;N = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c1 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c2 = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c3 = &#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">N =</span><br><span class="hljs-string">17687156112047658916576175030063333258687770834244899450617562420363386011962151231832</span><br><span class="hljs-string">11729278763896319183001842210823177413803654471977770262564053122127166306177216069180</span><br><span class="hljs-string">66048995683899616059388173629437673018386590043053146712870572300799479269947118251011</span><br><span class="hljs-string">967950970286626852935438101046112260915112568392601</span><br><span class="hljs-string">c1 =</span><br><span class="hljs-string">47280375006817082521114885578132104427687384457963920263778661542552259860890075321953</span><br><span class="hljs-string">56386765823334793012150783561241727843897900670501653759635767903847117695765983415569</span><br><span class="hljs-string">42843646827596758418082098123160949653935505099139848888499454210924638425466312286402</span><br><span class="hljs-string">93794745005338773574343676100121000764021207044019</span><br><span class="hljs-string">c2 =</span><br><span class="hljs-string">17623141093397913458588607801393364949837987344485194322493501097245276989960336468615</span><br><span class="hljs-string">82792691978911906437250081518121504288085503105877090086833394365901128027567671401021</span><br><span class="hljs-string">36304346001599401670291938369014436170693864034099138767167055456635760196888578642643</span><br><span class="hljs-string">971920733784690410395944410255241615897032471127315</span><br><span class="hljs-string">c3 =</span><br><span class="hljs-string">13559480788401697135681642316912816872734610240849028962388521117961957135410510239365</span><br><span class="hljs-string">82492923331793464974151297851846540082997256176686556408573180639927032654071620851788</span><br><span class="hljs-string">85733134590524577996093366819328960462500124201402816244104477018279673183368074374836</span><br><span class="hljs-string">717994805448310223434099196774685324616523478136309</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>根据上述题目代码，我们有：</p><p>$c_2\equiv m_2^{2025} mod(N)$</p><p>$c_3-e\equiv m_2^{2835} mod(N)$</p><p>观察2025与2835这两个数字，突然顿悟，发现他们的最大公约数为14175！</p><p>于是进行线性变化：</p><p>$(c_3-e)^5 - c_2^7&#x3D;0  mod(N)$</p><p><strong>至此，我们便可以使用Coppersmith攻击原理，求出e了！</strong></p><p>接下来就是其他知识点的考察了，不过我们能发现，运用Coppersmith我们对这道题的进度推进了很多！</p><p>我们注意到：</p><p>$m_1&#x3D;\sum 256^i*flag_i$</p><p>$m2 &#x3D; \sum 256^i *(flag_i+3)$</p><p>(这里利用了bytes_to_long函数的原理，将每个字符转换为八位二进制的数)</p><p>我们发现$m_2-m_1$是一个定值</p><p>于是我们可以对以下两个式子做相关消息攻击：</p><p>$c_1\equiv (e*m_1)^{2835} mod(N)$</p><p>$c_2\equiv (m_1+b)^{2025} mod(N)$</p><p>而m是大于n的，所以还需要做小范围爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">HGCD</span>(<span class="hljs-params">a, b</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-number">2</span> * b.degree() &lt; a.degree() <span class="hljs-keyword">or</span> a.degree() = <span class="hljs-number">1</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>m = a.degree() / <span class="hljs-number">2</span><br>a_top, a_bot = a.quo_rem(x^m)<br>b_top, b_bot = b.quo_rem(x^m)<br>R00, R01, R10, R11 = HGCD(a_top, b_top)<br>c = R00 * a + R01 * b<br>d = R10 * a + R11 * b<br>q, e = c.quo_rem(d)<br>d_top, d_bot = d.quo_rem(x^(m / <span class="hljs-number">2</span>))<br>e_top, e_bot = e.quo_rem(x^(m / <span class="hljs-number">2</span>))<br>S00, S01, S10, S11 = HGCD(d_top, e_top)<br>RET00 = S01 * R00 + (S00 - q * S01) * R10<br>RET01 = S01 * R01 + (S00 - q * S01) * R11<br>RET10 = S11 * R00 + (S10 - q * S11) * R10<br>RET11 = S11 * R01 + (S10 - q * S11) * R11<br><span class="hljs-keyword">return</span> RET00, RET01, RET10, RET11<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GCD</span>(<span class="hljs-params">a, b</span>):<br><span class="hljs-built_in">print</span>(a.degree(), b.degree())<br>q, r = a.quo_rem(b)<br><span class="hljs-keyword">if</span> r = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> b<br>R00, R01, R10, R11 = HGCD(a, b)<br>c = R00 * a + R01 * b<br>d = R10 * a + R11 * b<br><span class="hljs-keyword">if</span> d = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> c.monic()<br>q, r = c.quo_rem(d)<br><span class="hljs-keyword">if</span> r = <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> d<br><span class="hljs-keyword">return</span> GCD(d, r)<br>sys.setrecursionlimit(<span class="hljs-number">500000</span>)<br>N =<br><span class="hljs-number">17687156112047658916576175030063333258687770834244899450617562420363386011962151231832</span><br><span class="hljs-number">11729278763896319183001842210823177413803654471977770262564053122127166306177216069180</span><br><span class="hljs-number">66048995683899616059388173629437673018386590043053146712870572300799479269947118251011</span><br><span class="hljs-number">967950970286626852935438101046112260915112568392601</span><br>c1 =<br><span class="hljs-number">47280375006817082521114885578132104427687384457963920263778661542552259860890075321953</span><br><span class="hljs-number">56386765823334793012150783561241727843897900670501653759635767903847117695765983415569</span><br><span class="hljs-number">42843646827596758418082098123160949653935505099139848888499454210924638425466312286402</span><br><span class="hljs-number">93794745005338773574343676100121000764021207044019</span><br>c2 =<br><span class="hljs-number">17623141093397913458588607801393364949837987344485194322493501097245276989960336468615</span><br><span class="hljs-number">82792691978911906437250081518121504288085503105877090086833394365901128027567671401021</span><br><span class="hljs-number">36304346001599401670291938369014436170693864034099138767167055456635760196888578642643</span><br><span class="hljs-number">971920733784690410395944410255241615897032471127315</span><br>c3 =<br><span class="hljs-number">13559480788401697135681642316912816872734610240849028962388521117961957135410510239365</span><br><span class="hljs-number">82492923331793464974151297851846540082997256176686556408573180639927032654071620851788</span><br><span class="hljs-number">85733134590524577996093366819328960462500124201402816244104477018279673183368074374836</span><br><span class="hljs-number">717994805448310223434099196774685324616523478136309</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(N))<br>f = (c3 - x)^<span class="hljs-number">5</span> - c2^<span class="hljs-number">7</span><br>res = f.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">128</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.02</span>)<br>e = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>b =<br><span class="hljs-number">13860425563098439450464440586299944110869145799054471005966486822062551343046248376311</span><br><span class="hljs-number">97972917799925293608240198869587597177368766614530443357455736033307618174328289246889</span><br><span class="hljs-number">93026332102549607397901351619425324993583087500714061523945925857368498922102768458574</span><br><span class="hljs-number">857510324727265052999967460998294909713988129273348867</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(N))<br>f = (e * x)^<span class="hljs-number">2835</span> - c1<br>g = (x + b)^<span class="hljs-number">2025</span> - c2<br>res = GCD(f,g)<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>m = <span class="hljs-built_in">int</span>(-res.monic().coefficients()[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;m mod N = <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> trange(<span class="hljs-number">2</span>^<span class="hljs-number">16</span>):<br>mm = m + k*N<br>flag = long_to_bytes(<span class="hljs-built_in">int</span>(mm))<br><span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> flag:<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">break</span><br><span class="hljs-comment"># flag&#123;2404dcef-4223-417d-aee0-c236241f2320&#125;</span><br></code></pre></td></tr></table></figure><h3 id="3、西湖论剑-matrix-RSA"><a href="#3、西湖论剑-matrix-RSA" class="headerlink" title="3、西湖论剑 matrix RSA"></a>3、西湖论剑 matrix RSA</h3><p>先上题目：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>ext_len = <span class="hljs-number">9</span>*<span class="hljs-number">23</span> - <span class="hljs-built_in">len</span>(flag)<br>flag += <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.printable) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ext_len))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_rsa_encrypt</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p * q<br>    data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        data.append(bytes_to_long(flag[<span class="hljs-number">23</span>*i:<span class="hljs-number">23</span>*(i+<span class="hljs-number">1</span>)].encode()))<br>    M = Matrix(Zmod(n), [data[i:i+<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">3</span>)])<br>    e = <span class="hljs-number">65537</span><br>    C = M**e<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p &gt;&gt; <span class="hljs-number">100</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br>    <span class="hljs-keyword">return</span> C<br>C = my_rsa_encrypt()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;C =&quot;</span>, C)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">high_p = 12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551353785064416812665744581355110400</span><br><span class="hljs-string">p = 9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span><br><span class="hljs-string">n = 132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br><span class="hljs-string">C = [130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941  71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757  67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615]</span><br><span class="hljs-string">[ 23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993   9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601  44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401]</span><br><span class="hljs-string">[ 67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572  13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727  95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676]</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>我们能发现这里也有Coppersmith的踪迹！</p><p>于是先把p，q求出：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br>p4 = <span class="hljs-number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span><br>e =  <span class="hljs-number">65537</span><br>pbits = <span class="hljs-number">512</span><br>kbits = pbits - p4.nbits()<br><span class="hljs-built_in">print</span>(p4.nbits())<br>p4 = p4 &lt;&lt; kbits<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x + p4<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">0.4</span>)<br><span class="hljs-keyword">if</span> roots:        <br>p = p4+<span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>]) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n= &quot;</span>+<span class="hljs-built_in">str</span>(n))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p= &quot;</span>+<span class="hljs-built_in">str</span>(p))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q= &quot;</span>+<span class="hljs-built_in">str</span>(n//p))<br></code></pre></td></tr></table></figure><p>接下来就是一个非线性费马定理的使用了，这是以前从来没有接触过的东西捏<del>(￣▽￣)</del>*，也感谢学长的帮助，给到了文献参考！</p><p>[]: <a href="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf">https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n= <span class="hljs-number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br>p= <span class="hljs-number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span><br>q= <span class="hljs-number">10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span><br>e=<span class="hljs-number">65537</span><br>C =  [(<span class="hljs-number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,<span class="hljs-number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,<span class="hljs-number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>),(<span class="hljs-number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>, <span class="hljs-number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>, <span class="hljs-number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>), (<span class="hljs-number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>, <span class="hljs-number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>, <span class="hljs-number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>)]<br>C = matrix(Zmod(n), C)<br>phi=(p**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*(q**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>d = inverse(e,phi)<br>M = C**d<br>flag = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        m = <span class="hljs-built_in">int</span>(M[i,j])<br>        flag += long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h1><p>总的来说，Coppersmith攻击的考察是十分常见的，这一般用于解决 RSA 攻击中“已知某些二进制位，求剩余位”这一类问题</p><p>当然，Coppersmith攻击很少会直接考察，一般会与其他知识点结合起来形成综合题</p><p>因此，不断深入学习其他攻击方式也是十分重要的！</p>]]></content>
    
    
    <categories>
      
      <category>RSA</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>RSA考点之coppersmith</title>
    <link href="/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith1/"/>
    <url>/2025/01/19/RSA%E8%80%83%E7%82%B9%E4%B9%8Bcoppersmith1/</url>
    
    <content type="html"><![CDATA[<h1 id="Coppersmith攻击"><a href="#Coppersmith攻击" class="headerlink" title="Coppersmith攻击"></a>Coppersmith攻击</h1><p> <img src="/coppersmith.pdf" alt="图片引用方法二"> </p><p><img src="/images/coppersmith.pdf" alt="图片引用方法三"></p>]]></content>
    
    
    <categories>
      
      <category>RSA</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>非对称加密：RSA</title>
    <link href="/2024/12/08/RSA%E5%9F%BA%E7%A1%80/"/>
    <url>/2024/12/08/RSA%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="非对称加密：RSA"><a href="#非对称加密：RSA" class="headerlink" title="非对称加密：RSA"></a>非对称加密：RSA</h1><h2 id="基本知识介绍"><a href="#基本知识介绍" class="headerlink" title="基本知识介绍"></a>基本知识介绍</h2><h3 id="基本公式"><a href="#基本公式" class="headerlink" title="基本公式"></a>基本公式</h3><h4 id="一、欧拉函数"><a href="#一、欧拉函数" class="headerlink" title="一、欧拉函数"></a>一、欧拉函数</h4><h4 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义:"></a>1、定义:</h4><p>对于一个正整数n，n的欧拉函数ϕ ( n ) ，表示≤n与n互质的正整数的个数</p><h4 id="2、性质："><a href="#2、性质：" class="headerlink" title="2、性质："></a>2、性质：</h4><p>（1）如果n是质数，那么<img src="/images/5.png"></p><p>因为只有n本身与它不互质。</p><p>（2）如果p，q都是质数，那么<img src="/images/6.png"> </p><p>推导：推导:p , 2 p , 3 p , . . . . , ( q − 1 ) ∗ p 有 q − 1 个 数 整 除 p ∗ q ， 同 理 q , 2 q , 3 q , . . . , ( p − 1 ) ∗ q 有 p − 1 个 数 可 以 整 除 p q , 再 加 上 p q 本 身 能 整 除 p q ， 那 么 丢 掉 这 些 数 剩 余 的 数 就 与 p q 互 质 ， 一 共 有 p q − ( q − 1 + p − 1 + 1 ) &#x3D; ( p − 1 ) ( q − 1 ) 。 我们可以先进行一个简单的推广：a,b互质,<img src="/images/4.png"></p><p>继续进行推广便能得到第三个性质：</p><p>（3）如果p是质数，那么<img src="/images/3.png"></p><p>（4）对于任意正整数n，<img src="/images/2.png"></p><p> ， 其 中 p 1 , p 2 , p 3 , . . . , p n 是 n 的 质 因 子</p><p>（5）若a为质数,<img src="/images/1.png"></p><h4 id="二、欧拉定理"><a href="#二、欧拉定理" class="headerlink" title="二、欧拉定理"></a>二、欧拉定理</h4><p>若<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/65f10f65fcba30f32673bd2ffe9f8e006f5a624b" alt="{\displaystyle n,a}">为正整数，且n,a互素则<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2e818f3f88d3e71e569f171dd86f31e1903fdc55" alt="{\displaystyle a^{\varphi (n)}\equiv 1{\pmod {n}}}"></p><p>即<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bb559a70a1b64bfa864fcb458ef9ebd027dc734e" alt="{\displaystyle a^{\varphi (n)}}">与1在模n下同余</p><p>特别地，当n是素数的时候，φ(n)&#x3D;n−1，所以欧拉定理变为：</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3bfc8625369c7558deadd61823842db06983423d">或</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/578f207468d53d4691d91fa469583e2375107445" alt="{\displaystyle a^{n}\equiv a{\pmod {n}}}"></p><p>这就是<strong>费马小定理</strong></p><h4 id="三、中国剩余定理"><a href="#三、中国剩余定理" class="headerlink" title="三、中国剩余定理"></a>三、中国剩余定理</h4><p>在介绍这个定理之前，我们先介绍一些基本的数论知识</p><p>基本等式( 1 )  <strong>a m o d b &#x3D; ( a + k ∗ b ) m o d b</strong></p><p><strong>( 2 ) ( a ∗ k ) m o d b &#x3D; k ∗ ( a m o d b )</strong></p><p>那么我们设正整数m1、m2……mk两两互素，则同余方程组：</p><p><img src="/images/7.png"></p><p>有整数解，且在模M&#x3D;m1<em>m2</em>……*mk下的解是唯一的<img src="/images/8.png"></p><h4 id="四、威尔逊定理"><a href="#四、威尔逊定理" class="headerlink" title="四、威尔逊定理"></a>四、威尔逊定理</h4><p><img src="/images/9.png"></p><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><h4 id="公钥与私钥的产生"><a href="#公钥与私钥的产生" class="headerlink" title="公钥与私钥的产生"></a>公钥与私钥的产生</h4><ol><li><p>随机选择两个不同大质数 pp 和 qq，计算 N&#x3D;p×qN&#x3D;p×q</p></li><li><p>根据欧拉函数，求得<br>$$<br>φ(N)&#x3D;φ(p)φ(q)&#x3D;(p−1)(q−1)<br>$$</p></li><li><p>选择一个小于 φ(N) 的整数 e，使 e 和 φ(N) 互质。并求得 e 关于φ(N) 的模反元素，命名为d，有<br>$$<br>ed≡1(modφ(N))<br>$$</p></li><li><p>将 p 和 q 的记录销毁</p></li></ol><p>此时，(N,e)是公钥，(N,d)是私钥。</p><h4 id="消息加密"><a href="#消息加密" class="headerlink" title="消息加密"></a>消息加密</h4><p>首先需要将消息 以一个双方约定好的格式转化为一个小于 N，且与 N 互质的整数 m。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：<img src="/images/10.png"></p><h4 id="消息解密"><a href="#消息解密" class="headerlink" title="消息解密"></a>消息解密</h4><p>利用密钥 d 进行解密。<img src="/images/11.png"></p><h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>对于CTF中的crypto方向，我们主要使用的是<strong>Python</strong>（语法简单、可读性强且有很多强大的库）</p><p>下面我们用Python简单实现一下RSA的基本加密和解密过程：</p><p>1、生成两个大素数p，q</p><p>在实际使用RSA时，我们一般会用到512位、1024位甚至更高位数的素数（以后在crypto的内容中不特殊说明，所涉及到的位这一概念都是指二进制下的位数）</p><p>到这里，小萌新们可能会露出惊讶的表情：512位的素数怎么生成呢？</p><p>这就得发挥我们python的优势了：功能强大的库！</p><p>我们只需要在terminal中输入以下代码<img src="/images/12.png"></p><p>便可以成功安装。然后我们就可以利用这个功能强大的库来生成素数了。我们引入库中的子包：Crypto.Util.number（以后常用）<img src="/images/13.png"></p><p>接着就是正常运算即可<img src="/images/14.png"></p><p>2、选取e，并计算d</p><p>先上代码：<img src="/images/15.png"></p><p>这里<code>GCD</code>函数能够求解最大公因数（Greatest Common Divisor），这里我们用断言表达式认定e一定是和phi互素的。选择<code>65537</code>实际上这并不是硬性规定，一些标准提供了一些e的参考值，65537在各类实现与标准中被广泛使用，求d的过程中，我们使用了**<code>inverse</code>函数<strong>，该函数有两个参数<code>(a,p)</code>，作用便是</strong>求解<code>a</code>在模<code>p</code>意义下的乘法逆元**</p><p>至此我们便得到了公钥和私钥，随后我们便可以利用这组密钥进行加解密操作</p><p>对于我们要加密的信息，大部分情况下都不是一串长整型的数字，那么怎样将这样的信息利用RSA加密的方式进行加密呢？我们依然可以使用功能强大的库中的<strong>bytes_to_long</strong>函数，将字符串转换为数字</p><p><img src="/images/16.png"></p><p><img src="/images/17.png"></p><p>我们使用Python自带的<code>pow</code>函数进行幂运算，注意不要写成<code>m**e % n</code>，二者代表的意义相同，但是<code>pow</code>函数内置快速幂，可以快速得出结果，而<code>m**e % n</code>会将𝑚𝑒的结果先计算出来再取模，𝑚𝑒是一个非常大的数，这会消耗你计算机大量的运算和存储资源。</p><p>至此，我们便完成了加密过程，得到了RSA的密文C。</p><p>解密也很简单，只需要利用私钥：<img src="/images/18.png"></p><p>这便是RSA加解密的基本流程！</p>]]></content>
    
    
    <categories>
      
      <category>RSA</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Python库的使用一：sympy</title>
    <link href="/2024/12/08/Python%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%80%EF%BC%9Asympy%E5%BA%93/"/>
    <url>/2024/12/08/Python%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%80%EF%BC%9Asympy%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1 id="Sympy库"><a href="#Sympy库" class="headerlink" title="Sympy库"></a>Sympy库</h1><h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>作为一门易于上手、功能强大的编程语言，Python 拥有众多优秀的科学计算库。</p><p>其中，Sympy 库凭借其简单易懂的语法、丰富的功能和优雅的解决方法，逐渐成为 Python 开发者们解决数学计算问题的首选工具。</p><p>本文将重点介绍 Sympy 库的优势、常用函数方法、以及在CTF比赛中的简单应用。</p><h2 id="二、Sympy-库简介"><a href="#二、Sympy-库简介" class="headerlink" title="二、Sympy 库简介"></a>二、Sympy 库简介</h2><p>Sympy 是一个纯 Python 的数学计算库，可以用于解决从初中数学到高级数学的各类问题。</p><p>它支持符号计算、数值计算、代数运算、微积分、线性代数等功能，涵盖了数学、物理、工程等领域的大量应用。</p><h2 id="三、Sympy库的简单使用"><a href="#三、Sympy库的简单使用" class="headerlink" title="三、Sympy库的简单使用"></a>三、Sympy库的简单使用</h2><ul><li><p>表达式与表达式求值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#--------多项式求解--------</span><br><span class="hljs-comment">#定义变量</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>fx=<span class="hljs-number">5</span>*x+<span class="hljs-number">4</span><br><span class="hljs-comment">#使用evalf函数传值</span><br>y1=fx.evalf(subs=&#123;x:<span class="hljs-number">6</span>&#125;)<br><span class="hljs-built_in">print</span>(y1)<br><br><span class="hljs-comment">#多元表达式</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=sympy.Symbol(<span class="hljs-string">&#x27;y&#x27;</span>)<br>fx=x*x+y*y<br>result=fx.evalf(subs=&#123;x:<span class="hljs-number">3</span>,y:<span class="hljs-number">4</span>&#125;)<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure></li><li><p>函数方程求解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#解方程 有限解</span><br><span class="hljs-comment">#定义变量</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=sympy.Symbol(<span class="hljs-string">&#x27;y&#x27;</span>)<br>fx=x*<span class="hljs-number">3</span>+<span class="hljs-number">9</span><br><span class="hljs-comment">#可求解直接给出解向量</span><br><span class="hljs-built_in">print</span>(sympy.solve(fx,x))<br><br><span class="hljs-comment">#解方程无穷多解</span><br><span class="hljs-comment">#定义变量</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=sympy.Symbol(<span class="hljs-string">&#x27;y&#x27;</span>)<br>fx=x*<span class="hljs-number">3</span>+y**<span class="hljs-number">2</span><br><span class="hljs-comment">#得到是x与y的关系式，</span><br><span class="hljs-built_in">print</span>(sympy.solve(fx,x,y))<br><br><span class="hljs-comment">#解方程组</span><br><span class="hljs-comment">#定义变量</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>y=sympy.Symbol(<span class="hljs-string">&#x27;y&#x27;</span>)<br>f1=x+y-<span class="hljs-number">3</span><br>f2=x-y+<span class="hljs-number">5</span><br><span class="hljs-built_in">print</span>(sympy.solve([f1,f2],[x,y]))<br></code></pre></td></tr></table></figure></li><li><p>求和：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sympy<br><span class="hljs-comment">#定义变量</span><br>n=sympy.Symbol(<span class="hljs-string">&#x27;n&#x27;</span>)<br>f=<span class="hljs-number">2</span>*n<br><span class="hljs-comment">#前面参数放函数，后面放变量的变化范围</span><br>s=sympy.summation(f,(n,<span class="hljs-number">1</span>,<span class="hljs-number">100</span>))<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure></li><li><p>解带有求和式的方程：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#解释一下，i可以看做是循环变量，就是x自己加五次</span><br><span class="hljs-comment">#先定义变量，再写出方程</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>i=sympy.Symbol(<span class="hljs-string">&#x27;i&#x27;</span>)<br>f=sympy.summation(x,(i,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>))+<span class="hljs-number">10</span>*x-<span class="hljs-number">15</span><br>result=sympy.solve(f,x)<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure></li><li><p>求极限，求导，求积分：</p><p>（sympy.oo是无穷大的意思）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#求极限使用limit方法</span><br><span class="hljs-comment">#定义变量与函数</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>f1=sympy.sin(x)/x<br>f2=(<span class="hljs-number">1</span>+x)**(<span class="hljs-number">1</span>/x)<br>f3=(<span class="hljs-number">1</span>+<span class="hljs-number">1</span>/x)**x<br><span class="hljs-comment">#三个参数是 函数，变量，趋向值</span><br>lim1=sympy.limit(f1,x,<span class="hljs-number">0</span>)<br>lim2=sympy.limit(f2,x,<span class="hljs-number">0</span>)<br>lim3=sympy.limit(f3,x,sympy.oo)<br><span class="hljs-built_in">print</span>(lim1,lim2,lim3)<br><br><span class="hljs-comment">#求导使用diff方法</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>f1=<span class="hljs-number">2</span>*x**<span class="hljs-number">4</span>+<span class="hljs-number">3</span>*x+<span class="hljs-number">6</span><br><span class="hljs-comment">#参数是函数与变量</span><br>f1_=sympy.diff(f,x)<br><span class="hljs-built_in">print</span>(f1_)<br> <br>f2=sympy.sin(x)<br>f2_=sympy.diff(f2,x)<br><span class="hljs-built_in">print</span>(f2_)<br> <br><span class="hljs-comment">#求偏导</span><br>y=sympy.Symbol(<span class="hljs-string">&#x27;y&#x27;</span>)<br>f3=<span class="hljs-number">2</span>*x**<span class="hljs-number">2</span>+<span class="hljs-number">3</span>*y**<span class="hljs-number">4</span>+<span class="hljs-number">2</span>*y<br><span class="hljs-comment">#对x，y分别求导，即偏导</span><br>f3_x=sympy.diff(f3,x)<br>f3_y=sympy.diff(f3,y)<br><span class="hljs-built_in">print</span>(f3_x)<br><span class="hljs-built_in">print</span>(f3_y)<br><br><span class="hljs-comment">#求定积分用 integrate方法</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>f=<span class="hljs-number">2</span>*x<br><span class="hljs-comment">#参数传入 函数，积分变量和范围</span><br>result=sympy.integrate(f,(x,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(result)<br><br><span class="hljs-comment">#求多重积分，先求里面的积分，再求外面的</span><br>x,t=sympy.symbols(<span class="hljs-string">&#x27;x t&#x27;</span>)<br>f1=<span class="hljs-number">2</span>*t<br>f2=sympy.integrate(f1,(t,<span class="hljs-number">0</span>,x))<br>result=sympy.integrate(f2,(x,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>))<br><span class="hljs-built_in">print</span>(result)<br><br><span class="hljs-comment">#求不定积分其实和定积分区别不大</span><br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br>f=(sympy.E**x+<span class="hljs-number">2</span>*x)<br>f_=sympy.integrate(f,x)<br><span class="hljs-built_in">print</span>(f_)<br></code></pre></td></tr></table></figure></li><li><p>补充：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#虚数单位i</span><br>sympy.I<br><span class="hljs-comment">#自然对数低e</span><br>sympy.E<br><span class="hljs-comment">#无穷大</span><br>sympy.oo<br><span class="hljs-comment">#圆周率</span><br>sympy.pi<br><span class="hljs-comment">#求n次方根</span><br>sympy.root(<span class="hljs-number">8</span>,<span class="hljs-number">3</span>)<br><span class="hljs-comment">#求对数</span><br>sympy.log(<span class="hljs-number">1024</span>,<span class="hljs-number">2</span>)<br><span class="hljs-comment">#求阶乘</span><br>sympy.factorial(<span class="hljs-number">4</span>)<br><span class="hljs-comment">#三角函数</span><br>sympy.sin(sympy.pi)<br>sympy.tan(sympy.pi/<span class="hljs-number">4</span>)<br>sympy.cos(sympy.pi/<span class="hljs-number">2</span>)<br>x=sympy.Symbol(<span class="hljs-string">&#x27;x&#x27;</span>)<br><span class="hljs-comment">#公式展开用expand方法</span><br>f=(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>*x)*x**<span class="hljs-number">2</span><br>ff=sympy.expand(f)<br><span class="hljs-built_in">print</span>(ff)<br><span class="hljs-comment">#公式折叠用factor方法</span><br>f=x**<span class="hljs-number">2</span>+<span class="hljs-number">1</span>+<span class="hljs-number">2</span>*x<br>ff=sympy.factor(f)<br><span class="hljs-built_in">print</span>(ff)<br><span class="hljs-comment">#simplify( )普通的化简</span><br>simplify((x**<span class="hljs-number">3</span> + x**<span class="hljs-number">2</span> - x - <span class="hljs-number">1</span>)/(x**<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*x + <span class="hljs-number">1</span>))<br><span class="hljs-comment">#trigsimp( )三角化简</span><br>trigsimp(sin(x)/cos(x))<br><span class="hljs-comment">#powsimp( )指数化简</span><br>powsimp(x**a*x**b)<br></code></pre></td></tr></table></figure></li></ul><h2 id="四、sympy库在CTF比赛中的运用"><a href="#四、sympy库在CTF比赛中的运用" class="headerlink" title="四、sympy库在CTF比赛中的运用"></a>四、sympy库在CTF比赛中的运用</h2><p>在了解了sympy库的基本使用方法后，我们就要将它运用到CTF实战中了</p><p>那么在CTF中我们主要利用sympy库解决什么问题呢？或者说CTF的题目中出现什么问题需要通过sympy库来解决呢？根据笔者浅薄的做题经验以及在网上的信息搜集能够得出：</p><h5 id="在CTF比赛中，利用sympy我们能够快速且高效的解决离散对数相关的问题！"><a href="#在CTF比赛中，利用sympy我们能够快速且高效的解决离散对数相关的问题！" class="headerlink" title="在CTF比赛中，利用sympy我们能够快速且高效的解决离散对数相关的问题！"></a>在CTF比赛中，利用sympy我们能够快速且高效的解决<strong>离散对数</strong>相关的问题！</h5><h3 id="离散对数的基本介绍"><a href="#离散对数的基本介绍" class="headerlink" title="离散对数的基本介绍"></a>离散对数的基本介绍</h3><p>在这里我们先对离散对数问题进行一个简单的介绍，让读者对离散对数这个概念有简单的认识。</p><p><img src="/images/testa.png"></p><h3 id="与离散对数库相关的sympy库的使用"><a href="#与离散对数库相关的sympy库的使用" class="headerlink" title="与离散对数库相关的sympy库的使用"></a>与离散对数库相关的sympy库的使用</h3><p>在有了简单的认识后，接下来让我们隆重推出sympy库中的函数：discrete_log函数！</p><p>利用这个函数，我们能够高效且快捷的解决离散对数问题！</p><p>函数discrete_log(x,y,z)中，x是模数，y是余数，z是底数，返回值就是要求的指数</p><p>下面我们先给出一个简单的实例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> discrete_log<br><span class="hljs-meta">&gt;&gt;&gt; </span>discrete_log(<span class="hljs-number">41</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>)<br><span class="hljs-number">3</span><br><br></code></pre></td></tr></table></figure><p>（这里利用discrete函数求出了在模41的情况下与15同余的7的多少次方的次方数）</p><h3 id="具体题目实践"><a href="#具体题目实践" class="headerlink" title="具体题目实践"></a>具体题目实践</h3><p>下面我们给出两道题目加深一下印象：</p><h4 id="第一道题的题目代码如下："><a href="#第一道题的题目代码如下：" class="headerlink" title="第一道题的题目代码如下："></a>第一道题的题目代码如下：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> gmpy2<br><br>m = bytes_to_long(<span class="hljs-string">b&#x27;flag&#123;*****&#125;&#x27;</span>)<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>r = getPrime(<span class="hljs-number">512</span>)<br>h1 = <span class="hljs-number">1</span>*p + <span class="hljs-number">1</span>*q + <span class="hljs-number">1</span>*r<br>h2 = <span class="hljs-number">2</span>*p + <span class="hljs-number">3</span>*q + <span class="hljs-number">3</span>*r<br>h3 = <span class="hljs-number">9</span>*p + <span class="hljs-number">9</span>*q + <span class="hljs-number">6</span>*r<br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;hint_of_pqr=&quot;</span> , h1 , h2 , h3 )<br><br>e = getPrime(<span class="hljs-number">64</span>)<br>a_big_prime = getPrime( <span class="hljs-number">512</span> )<br>hint = <span class="hljs-built_in">pow</span>(a_big_prime,e,<span class="hljs-number">2</span>**<span class="hljs-number">512</span>)<br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;big_prime is: &quot;</span> , a_big_prime )<br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;hint is: &quot;</span> , hint )<br><br>n = p*q*r<br>c = <span class="hljs-built_in">pow</span>( m , e , n )<br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;c=&quot;</span> , c )<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">hint_of_pqr= 31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497 83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760 248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172 </span><br><span class="hljs-string">big_prime is:  10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span><br><span class="hljs-string">hint is:  1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571 </span><br><span class="hljs-string">c= 999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>我们能够发现这题的关键不是素数分解，而是想办法把e求出来，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">hint = <span class="hljs-built_in">pow</span>(a_big_prime,e,<span class="hljs-number">2</span>**<span class="hljs-number">512</span>)<br></code></pre></td></tr></table></figure><p>通过这一段代码以及给出的数据，我们能够发现这就是一个标准的离散对数问题，因为在这段代码中，只有e是不知道的且e就是一个离散对数，那么我们就能利用discrete_log函数来求解了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> gmpy2<br><br>h1 = <span class="hljs-number">31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497</span><br>h2 = <span class="hljs-number">83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760</span><br>h3 = <span class="hljs-number">248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172</span><br>c = <span class="hljs-number">999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span><br>a_big_prime = <span class="hljs-number">10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span><br>hint = <span class="hljs-number">1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571</span><br><br>p = <span class="hljs-number">3</span> * h1 - h2<br>r = (<span class="hljs-number">9</span> * h1 - h3) // <span class="hljs-number">3</span><br>q = h1 - p - r<br>n = p * q * r<br><br>e = sympy.discrete_log(<span class="hljs-number">2</span>**<span class="hljs-number">512</span>, hint, a_big_prime)<br><br>d = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c , d , n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment"># flag&#123;th1s_2s_A_rea119_f34ggg&#125;</span><br></code></pre></td></tr></table></figure><h4 id="第二道题的代码如下："><a href="#第二道题的代码如下：" class="headerlink" title="第二道题的代码如下："></a>第二道题的代码如下：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>n = <span class="hljs-number">2</span> ** <span class="hljs-number">512</span><br>m = random.randint(<span class="hljs-number">2</span>, n-<span class="hljs-number">1</span>) | <span class="hljs-number">1</span><br>c = <span class="hljs-built_in">pow</span>(m, bytes_to_long(flag), n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;m = &#x27;</span> + <span class="hljs-built_in">str</span>(m)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;c = &#x27;</span> + <span class="hljs-built_in">str</span>(c)<br><br><span class="hljs-comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="hljs-comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br><br></code></pre></td></tr></table></figure><p>也是一个标准的离散对数问题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy.ntheory <span class="hljs-keyword">import</span> discrete_log<br>n = <span class="hljs-number">2</span>**<span class="hljs-number">512</span><br>m = <span class="hljs-number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br>c = <span class="hljs-number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br>flag_dec = discrete_log(n,c,m) <span class="hljs-comment">#得到flag的十进制值</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(flag_dec)) <span class="hljs-comment">#转为十六进制后打印出来</span><br><br></code></pre></td></tr></table></figure><p>得到十六进制表示后，转化为ascⅡ即可</p><h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><p>总的来说，sympy库是一个功能十分强大的库，虽然在某些情况下sympy的功能不如sagemath（比如矩阵相关的运算），但他作为python的一个库还是体现了非常强大的功能，在CTF比赛中，sympy库中的discrete_log函数也是一个常见的命题点。</p>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2024/11/16/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/"/>
    <url>/2024/11/16/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>这是一篇测试文章</p><img src="/2024/11/16/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/test.png" class="" title="图片引用方法一"> ]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/11/16/hello-world/"/>
    <url>/2024/11/16/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
